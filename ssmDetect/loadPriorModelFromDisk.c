/*
 * File: loadPriorModelFromDisk.c
 *
 * MATLAB Coder version            : 2.7
 * C/C++ source code generated on  : 04-Mar-2021 10:19:22
 */

/* Include Files */
#include "rt_nonfinite.h"
#include "ssmDetect.h"
#include "loadPriorModelFromDisk.h"
#include "inv.h"

/* Function Definitions */

/*
 * Arguments    : Colorspace type_colorspace
 *                Colorspace *model_prior_type_colorspace
 *                struct1_T model_prior_mixture[3]
 *                boolean_T *model_prior_is_initialized
 *                double em_image_size[2]
 * Return Type  : void
 */
void loadPriorModelFromDisk(Colorspace type_colorspace, Colorspace
  *model_prior_type_colorspace, struct1_T model_prior_mixture[3], boolean_T
  *model_prior_is_initialized, double em_image_size[2])
{
  double a_parameters_EM_params[27];
  static const double dv0[27] = { 0.22255713506940075, 0.36737365106979508,
    0.081301896920308633, 0.76731072350934693, 0.43398675877950488,
    0.26038445830550094, 0.26695407409499394, 0.33013026742072893,
    0.76529346851507, 0.38345079363736623, 0.22562918187432957,
    0.41866430274429195, 0.28918543250927525, 0.13660284463899561,
    0.19324918113159892, 0.067308129185440616, 0.14443661474401484,
    0.28771377104551304, 0.094670110519762762, 0.15933242820377219,
    0.24383612361362722, 0.23888453512529906, 0.2889854391840877,
    0.19759945000516146, 0.1036086383033096, 0.13533842107709573,
    0.13670458963442664 };

  static const double dv1[27] = { 0.22255713506940075, 77.385868210881753,
    -4.5080690629202218, 0.30465871070771405, 0.43398675877950488,
    32.434370524284724, -4.5758863391419649, 7.2690482797198239,
    0.76529346851507, 43.164604337060211, -15.131072310920432,
    5.3791024416354691, 0.28901678535795355, 0.13472747115192912,
    13.3651372763181, 3.7405353425371861, 6.6685162355273, 0.28694105846356155,
    0.088358156274953414, 25.612560496767934, 5.3872292249902074,
    8.2011000868062922, 0.28888888693593179, 0.14456509687318153,
    14.961922097345937, 7.8027792125790389, 4.5756686845676553 };

  static const double dv2[27] = { 0.22255713506940075, 183.67471799387764,
    192.12378915586865, 190.21386337904138, 0.43398675877950488,
    79.1810592976396, 81.917530224525038, 71.267271157167528, 0.76529346851507,
    86.098524036140418, 106.6484240292434, 95.986585281743572,
    0.28918543250927525, 0.13660284463899561, 39.035838489141057,
    36.124380088841988, 36.802336167162622, 0.28771377104551304,
    0.094670110519762762, 60.84314293284622, 60.071031493112109,
    57.849101935220716, 0.2889854391840877, 0.19759945000516146,
    35.976665080020872, 34.877811377552995, 33.214901864816824 };

  static const double dv3[27] = { 0.22255713506940075, 178.64905438839267,
    128.41460141736906, 124.42877510798004, 0.43398675877950488,
    84.600460564191138, 123.67544617156017, 127.55325273459988, 0.76529346851507,
    101.24332712600869, 126.34678253672666, 119.76863921649769,
    0.28918543250927525, 0.13660284463899561, 31.414085235139613,
    5.5152295599693151, 5.1599866590524242, 0.28771377104551304,
    0.094670110519762762, 51.348804358182129, 5.1186460205001376,
    4.2182999516691115, 0.2889854391840877, 0.19759945000516146,
    29.680468368369194, 2.95711292311264, 5.1117619299753283 };

  static const double dv4[27] = { 0.22255713506940075, 178.64905438839267,
    128.41460141736906, 0.081301896920308633, 0.43398675877950488,
    84.600460564191138, 123.67544617156017, 0.26695407409499394,
    0.76529346851507, 101.24332712600869, 126.34678253672666,
    0.22562918187432957, 0.28918543250927525, 0.13660284463899561,
    31.414085235139613, 5.5152295599693151, 0.067308129185440616,
    0.28771377104551304, 0.094670110519762762, 51.348804358182129,
    5.1186460205001376, 0.24383612361362722, 0.2889854391840877,
    0.19759945000516146, 29.680468368369194, 2.95711292311264,
    0.13533842107709573 };

  int i0;
  int i;
  static const struct1_T rv0[3] = { { { 0.0, 0.0, 0.0, 0.0, 0.0 }, { 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 }, 0.0, { 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 } }, { { 0.0, 0.0, 0.0, 0.0, 0.0 }, {
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 }, 0.0, { 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 } }, { { 0.0, 0.0, 0.0, 0.0,
        0.0 }, { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 }, 0.0, { 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 } } };

  int b_i;
  double x_data[15];
  int loop_ub;
  double mu[5];
  double y[5];

  /* a = coder.load('EM_parameters_ycrcb.mat'); %Added */
  switch (type_colorspace) {
   case hsv:
    memcpy(&a_parameters_EM_params[0], &dv0[0], 27U * sizeof(double));
    break;

   case lab:
    memcpy(&a_parameters_EM_params[0], &dv1[0], 27U * sizeof(double));
    break;

   case rgb:
    memcpy(&a_parameters_EM_params[0], &dv2[0], 27U * sizeof(double));
    break;

   case ycrcb:
    memcpy(&a_parameters_EM_params[0], &dv3[0], 27U * sizeof(double));
    break;

   case ycrs:
    memcpy(&a_parameters_EM_params[0], &dv4[0], 27U * sizeof(double));
    break;
  }

  for (i0 = 0; i0 < 2; i0++) {
    em_image_size[i0] = 50.0;
  }

  /*  project to pixels */
  for (i = 0; i < 3; i++) {
    model_prior_mixture[i] = rv0[i];
  }

  for (i = 0; i < 3; i++) {
    i0 = (i << 2) + 1;
    b_i = (1 + i) << 2;
    if (i0 > b_i) {
      i0 = 1;
      b_i = 0;
    }

    x_data[0] = 25.0;
    loop_ub = b_i - i0;
    for (b_i = 0; b_i <= loop_ub; b_i++) {
      x_data[b_i + 1] = a_parameters_EM_params[(i0 + b_i) - 1];
    }

    for (b_i = 0; b_i < 5; b_i++) {
      mu[b_i] = x_data[b_i];
    }

    /* disp('Size of mu :'); disp(size(mu));  */
    mu[1] *= 50.0;
    for (b_i = 0; b_i < 5; b_i++) {
      model_prior_mixture[i].Mu[b_i] = mu[b_i];
    }

    i0 = 5 * i;
    if (i0 + 1 > 5 * (1 + i)) {
      i0 = 12;
    } else {
      i0 += 12;
    }

    for (b_i = 0; b_i < 5; b_i++) {
      mu[b_i] = a_parameters_EM_params[i0 + b_i];
    }

    /* disp('Size of S: '); disp(size(S)); */
    for (i0 = 0; i0 < 2; i0++) {
      mu[i0] *= 50.0;
    }

    for (b_i = 0; b_i < 5; b_i++) {
      y[b_i] = mu[b_i] * mu[b_i];
    }

    for (i0 = 0; i0 < 25; i0++) {
      model_prior_mixture[i].Cov[i0] = 0.0;
    }

    for (b_i = 0; b_i < 5; b_i++) {
      model_prior_mixture[i].Cov[b_i + 5 * b_i] = y[b_i];
    }

    inv(model_prior_mixture[i].Cov, model_prior_mixture[i].Prec);
  }

  *model_prior_type_colorspace = type_colorspace;
  *model_prior_is_initialized = true;
}

/*
 * File trailer for loadPriorModelFromDisk.c
 *
 * [EOF]
 */
