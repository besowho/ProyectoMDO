<pre class="code">
<span class="srcline"><span class="lineno"><a href="189,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T6U3">Mu</span> = mergePd( <span class="var type1" id="S3T6U6">Mu_d</span>, <span class="var type1" id="S4T7U7">C_d</span>, <span class="var type1" id="S5T6U8">Mu_0</span>, <span class="var type1" id="S6T7U9">iC0</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="189,2" id="srcline2"> 2</a></span><span class="line"> <span class="comment">%#codegen </span></span></span>
<span class="srcline"><span class="lineno"><a href="189,3" id="srcline3"> 3</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="189,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T4:U6"><span class="var type1" id="S7T4U12">d</span> = <span class="mxinfo " id="T4:U8">size(<span class="var type1" id="S4T7U15">C_d</span>,1)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="189,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% approximately robust</span></span></span>
<span class="srcline"><span class="lineno"><a href="189,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T4:U10"><span class="var type1" id="S9T4U19">scl</span> = <span class="mxinfo " id="T4:U12">1e-10</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="189,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T6:U13"><span class="var type1" id="S10T6U23">tmpB</span>=<span class="mxinfo " id="T6:U15">diag(<span class="var type1" id="S4T7U26">C_d</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="189,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T7:U17"><span class="var type1" id="S12T7U29">tmpC</span>= <span class="mxinfo " id="T7:U19"><span class="var type1" id="S4T7U31">C_d</span>+<span class="mxinfo " id="T7:U21"><span class="mxinfo " id="T7:U22"><span class="mxinfo " id="T7:U23">eye(<span class="var type1" id="S7T4U36">d</span>)</span>*<span class="mxinfo " id="T4:U25">mean(<span class="mxinfo " id="T6:U26"><span class="var type1" id="S10T6U40">tmpB</span>(:)</span>)</span></span>*<span class="mxinfo " id="T4:U28"><span class="var type1" id="S9T4U42">scl</span></span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="189,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="189,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T6:U30"><span class="var type1" id="S2T6U45">Mu</span> = <span class="mxinfo " id="T6:U32">(<span class="mxinfo " id="T7:U33"><span class="mxinfo " id="T7:U34">inv(<span class="var type1" id="S12T7U51">tmpC</span>)</span> + <span class="var type1" id="S6T7U52">iC0</span></span>)\(<span class="mxinfo " id="T6:U37"><span class="mxinfo " id="T6:U38"><span class="var type1" id="S12T7U56">tmpC</span>\<span class="var type1" id="S3T6U57">Mu_d</span></span> + <span class="mxinfo " id="T6:U41"><span class="var type1" id="S6T7U59">iC0</span>*<span class="var type1" id="S5T6U60">Mu_0</span></span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="189,11" id="srcline11">11</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
