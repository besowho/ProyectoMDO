<pre class="code">
<span class="srcline"><span class="lineno"><a href="153,1" id="srcline1">1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T84U3">y</span> = normpdf(<span class="var type1" id="S3T61U6">x</span>,<span class="var type1" id="S4T6U7">mu</span>,<span class="mxinfo " id="T46:U4"><span class="mxinfo " id="T46:U5">~</span></span>,<span class="var type1" id="S5T7U9">sigma</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="153,2" id="srcline2">2</a></span><span class="line">    [<span class="mxinfo " id="T7:U7"><span class="var type1" id="S6T7U13">U</span></span>,<span class="mxinfo " id="T7:U9"><span class="var type1" id="S7T7U14">S</span></span>,<span class="mxinfo " id="T4:U11"><span class="mxinfo " id="T4:U12">~</span></span>] = svd(<span class="var type1" id="S5T7U18">sigma</span>) ;</span></span>
<span class="srcline"><span class="lineno"><a href="153,3" id="srcline3">3</a></span><span class="line">    <span class="mxinfo " id="T6:U14"><span class="var type1" id="S9T6U21">s</span> = <span class="mxinfo " id="T6:U16">diag(<span class="var type1" id="S7T7U24">S</span>)</span></span> ; <span class="mxinfo " id="T408:U18"><span class="mxinfo " id="T408:U19"><span class="var type1" id="S9T6U28">s</span>(<span class="mxinfo " id="T80:U21"><span class="var type1" id="S9T6U30">s</span>&lt;<span class="mxinfo " id="T4:U23">eps</span></span>)</span> = <span class="mxinfo " id="T4:U24">1</span></span> ; <span class="mxinfo " id="T7:U25"><span class="var type1" id="S7T7U36">S</span> = <span class="mxinfo " id="T7:U27">diag(<span class="var type1" id="S9T6U39">s</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="153,4" id="srcline4">4</a></span><span class="line">    <span class="mxinfo " id="T83:U29"><span class="var type1" id="S12T83U42">A</span> = <span class="mxinfo " id="T83:U31"><span class="mxinfo " id="T83:U32"><span class="mxinfo " id="T61:U33">bsxfun(@minus, <span class="var type1" id="S3T61U49">x</span>, <span class="var type1" id="S4T6U50">mu</span>)</span>'</span> * (<span class="mxinfo " id="T7:U36"><span class="var type1" id="S6T7U53">U</span>*<span class="mxinfo " id="T7:U38">diag(<span class="mxinfo " id="T6:U39"><span class="mxinfo " id="T4:U40">1</span>./<span class="mxinfo " id="T6:U41">diag(<span class="mxinfo " id="T7:U42">sqrt(<span class="var type1" id="S7T7U62">S</span>)</span>)</span></span>)</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="153,5" id="srcline5">5</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="153,6" id="srcline6">6</a></span><span class="line">    <span class="mxinfo " id="T84:U44"><span class="var type1" id="S2T84U65">y</span> = <span class="mxinfo " id="T84:U46"><span class="mxinfo " id="T84:U47">exp(<span class="mxinfo " id="T84:U48"><span class="mxinfo " id="T4:U49">-0.5</span>*<span class="mxinfo " id="T84:U50">sum(<span class="mxinfo " id="T83:U51"><span class="var type1" id="S12T83U75">A</span> .* <span class="var type1" id="S12T83U76">A</span></span>, 2)</span></span>)</span> / (<span class="mxinfo " id="T4:U54"><span class="mxinfo " id="T4:U55">sqrt(<span class="mxinfo " id="T4:U56">2*pi</span>)</span> .* <span class="mxinfo " id="T4:U57">prod(<span class="mxinfo " id="T6:U58">diag(<span class="var type1" id="S7T7U90">S</span>)</span>)</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="153,7" id="srcline7">7</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
