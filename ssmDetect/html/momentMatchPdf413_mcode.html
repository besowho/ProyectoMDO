<pre class="code">
<span class="srcline"><span class="lineno"><a href="114,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Originally a part of: Maggot (developed within EU project CogX)</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Author: Matej Kristan, 2009 (matej.kristan@fri.uni-lj.si; http://vicos.fri.uni-lj.si/matejk/)</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Last revised: 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T15U3">component</span> = momentMatchPdf(<span class="var type1" id="S3T6U6">Mu1</span>, <span class="var type1" id="S4T6U7">Mu2</span>, <span class="var type1" id="S5T7U8">Cov1</span>, <span class="var type1" id="S6T7U9">Cov2</span>, <span class="var type1" id="S7T8U10">w</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="114,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T4:U7"><span class="var type1" id="S8T4U13">sum_w</span> = <span class="mxinfo " id="T4:U9">sum(<span class="var type1" id="S7T8U16">w</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="114,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T8:U11"><span class="var type1" id="S7T8U19">w</span> = <span class="mxinfo " id="T8:U13"><span class="var type1" id="S7T8U21">w</span>/<span class="mxinfo " id="T4:U15"><span class="var type1" id="S8T4U22">sum_w</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="114,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,14" id="srcline14">14</a></span><span class="line"><span class="comment">% % new_mu =  sum(bsxfun(@times,Mu, w),2) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,15" id="srcline15">15</a></span><span class="line"><span class="comment">%new_mu =  sum(bsxfun(@times,[Mu1,Mu2], w),2) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T74:U17"><span class="var type1" id="S10T74U25">a</span> = <span class="mxinfo " id="T74:U19">[<span class="var type1" id="S3T6U28">Mu1</span>,<span class="var type1" id="S4T6U29">Mu2</span>]</span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="114,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T74:U22"><span class="var type1" id="S11T74U32">multi</span>=<span class="mxinfo " id="T74:U24">zeros(size(<span class="var type1" id="S10T74U37">a</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,18" id="srcline18">18</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S14T4U40">k</span>=<span class="mxinfo " id="T4:U27">1</span>:size(<span class="var type1" id="S10T74U45">a</span>,2),</span></span>
<span class="srcline"><span class="lineno"><a href="114,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T6:U29"><span class="mxinfo " id="T6:U30"><span class="var type1" id="S11T74U50">multi</span>(:,<span class="var type1" id="S14T4U52">k</span>)</span>= <span class="mxinfo " id="T6:U33"><span class="mxinfo " id="T6:U34"><span class="var type1" id="S10T74U55">a</span>(:,<span class="var type1" id="S14T4U57">k</span>)</span>.*<span class="mxinfo " id="T4:U37"><span class="var type1" id="S7T8U59">w</span>(<span class="var type1" id="S14T4U60">k</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T6:U40"><span class="var type1" id="S15T6U63">new_mu</span>=<span class="mxinfo " id="T6:U42">sum(<span class="var type1" id="S11T74U66">multi</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,23" id="srcline23">23</a></span><span class="line"><span class="comment">% %n = size(new_mu,1) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,24" id="srcline24">24</a></span><span class="line"><span class="comment">% %     new_Cov = zeros(n,n) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,25" id="srcline25">25</a></span><span class="line"><span class="comment">% %    if n==1</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,26" id="srcline26">26</a></span><span class="line"><span class="comment">% %         new_Cov = sum(w.*(cell2mat(Cov) + Mu.*Mu)) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,27" id="srcline27">27</a></span><span class="line"><span class="comment">% %     else</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,28" id="srcline28">28</a></span><span class="line"><span class="comment">% %         for j=1:length(w)</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,29" id="srcline29">29</a></span><span class="line"><span class="comment">% %             </span></span></span>
<span class="srcline"><span class="lineno"><a href="114,30" id="srcline30">30</a></span><span class="line"><span class="comment">% %             new_Cov = new_Cov + w(j)*( Cov{j} + Mu(:,j)*Mu(:,j)') ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,31" id="srcline31">31</a></span><span class="line"><span class="comment">% %         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,32" id="srcline32">32</a></span><span class="line"><span class="comment">% %     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,33" id="srcline33">33</a></span><span class="line"><span class="comment">% %     new_Cov = new_Cov - new_mu*new_mu' ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T15:U44"><span class="var type1" id="S2T15U70">component</span>=<span class="mxinfo " id="T15:U46"><span class="fcn" id="F403N2:B72">MixtureComponent</span>(1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T6:U47"><span class="mxinfo " id="T6:U48"><span class="var type1" id="S2T15U77">component</span>.Mu</span>=<span class="mxinfo " id="T6:U50"><span class="mxinfo " id="T6:U51"><span class="mxinfo " id="T4:U52"><span class="var type1" id="S7T8U82">w</span>(<span class="mxinfo " id="T4:U54">1</span>)</span>*<span class="var type1" id="S3T6U84">Mu1</span></span>+<span class="mxinfo " id="T6:U56"><span class="mxinfo " id="T4:U57"><span class="var type1" id="S7T8U87">w</span>(<span class="mxinfo " id="T4:U59">2</span>)</span>*<span class="var type1" id="S4T6U89">Mu2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T7:U61"><span class="mxinfo " id="T7:U62"><span class="var type1" id="S2T15U93">component</span>.Cov</span>=<span class="mxinfo " id="T7:U64"><span class="mxinfo " id="T7:U65"><span class="mxinfo " id="T7:U66"><span class="mxinfo " id="T4:U67"><span class="var type1" id="S7T8U99">w</span>(<span class="mxinfo " id="T4:U69">1</span>)</span>*(<span class="mxinfo " id="T7:U70"><span class="var type1" id="S5T7U103">Cov1</span>+<span class="mxinfo " id="T7:U72"><span class="var type1" id="S3T6U105">Mu1</span>*<span class="mxinfo " id="T75:U74"><span class="var type1" id="S3T6U107">Mu1</span>'</span></span></span>)</span>+<span class="mxinfo " id="T7:U76"><span class="mxinfo " id="T4:U77"><span class="var type1" id="S7T8U110">w</span>(<span class="mxinfo " id="T4:U79">2</span>)</span>*(<span class="mxinfo " id="T7:U80"><span class="var type1" id="S6T7U114">Cov2</span>+<span class="mxinfo " id="T7:U82"><span class="var type1" id="S4T6U116">Mu2</span>*<span class="mxinfo " id="T75:U84"><span class="var type1" id="S4T6U118">Mu2</span>'</span></span></span>)</span></span>-<span class="mxinfo " id="T7:U86"><span class="var type1" id="S15T6U120">new_mu</span>*<span class="mxinfo " id="T75:U88"><span class="var type1" id="S15T6U122">new_mu</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T4:U90"><span class="mxinfo " id="T4:U91"><span class="var type1" id="S2T15U126">component</span>.w</span>=<span class="mxinfo " id="T4:U93"><span class="var type1" id="S8T4U128">sum_w</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,39" id="srcline39">39</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,40" id="srcline40">40</a></span><span class="line"></span></span>
</pre>
