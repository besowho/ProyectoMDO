<pre class="code">
<span class="srcline"><span class="lineno"><a href="203,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T354U3">R</span> = extractTheLargestRegion (<span class="var type1" id="S3T354U6">T</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="203,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Copy input image and clear it</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T354:U3"><span class="var type1" id="S2T354U9">R</span> = <span class="var type1" id="S3T354U10">T</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T354:U6"><span class="mxinfo " id="T354:U7"><span class="var type1" id="S2T354U14">R</span>(:,:,:)</span> = <span class="mxinfo " id="T4:U9">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Find connected components</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T374:U10"><span class="var type1" id="S4T374U21">CC</span> = <span class="mxinfo " id="T374:U12"><span class="fcn" id="F1486N21:B23">replacement_bwconncomp</span>(<span class="var type1" id="S3T354U24">T</span>, 8)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,12" id="srcline12">12</a></span><span class="line"><span class="comment">% Find the largest component</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,13" id="srcline13">13</a></span><span class="line"><span class="comment">%[ ~, max_idx ] = max([ CC.area ]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T4:U14"><span class="var type1" id="S6T4U28">max_idx</span> = <span class="mxinfo " id="T4:U16">-<span class="mxinfo " id="T4:U17">1</span></span></span>; <span class="mxinfo " id="T4:U18"><span class="var type1" id="S7T4U33">max_val</span> = <span class="mxinfo " id="T4:U20">-<span class="mxinfo " id="T4:U21">inf</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,15" id="srcline15">15</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S9T4U39">i</span> = <span class="mxinfo " id="T4:U23">1</span>:<span class="mxinfo " id="T4:U24">numel(<span class="var type1" id="S4T374U44">CC</span>)</span>,</span></span>
<span class="srcline"><span class="lineno"><a href="203,16" id="srcline16">16</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T2:U26"><span class="mxinfo " id="T4:U27"><span class="mxinfo " id="T483:U28"><span class="var type1" id="S4T374U50">CC</span>(<span class="var type1" id="S9T4U51">i</span>)</span>.area</span> &gt; <span class="var type1" id="S7T4U53">max_val</span></span>,</span></span>
<span class="srcline"><span class="lineno"><a href="203,17" id="srcline17">17</a></span><span class="line">        <span class="mxinfo " id="T4:U32"><span class="var type1" id="S7T4U56">max_val</span> = <span class="mxinfo " id="T4:U34"><span class="mxinfo " id="T483:U35"><span class="var type1" id="S4T374U59">CC</span>(<span class="var type1" id="S9T4U60">i</span>)</span>.area</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo " id="T4:U38"><span class="var type1" id="S6T4U64">max_idx</span> = <span class="var type1" id="S9T4U65">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,19" id="srcline19">19</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,22" id="srcline22">22</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T2:U41"><span class="var type1" id="S6T4U69">max_idx</span> == <span class="mxinfo " id="T4:U43">-<span class="mxinfo " id="T4:U44">1</span></span></span>,</span></span>
<span class="srcline"><span class="lineno"><a href="203,23" id="srcline23">23</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,24" id="srcline24">24</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,25" id="srcline25">25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="203,26" id="srcline26">26</a></span><span class="line"><span class="comment">% "Fill" the largest component into empty output image</span></span></span>
<span class="srcline"><span class="lineno"><a href="203,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T484:U45"><span class="mxinfo " id="T484:U46"><span class="var type1" id="S2T354U76">R</span>(<span class="mxinfo " id="T373:U48"><span class="mxinfo " id="T483:U49"><span class="var type1" id="S4T374U79">CC</span>(<span class="var type1" id="S6T4U80">max_idx</span>)</span>.pixel_idx</span>)</span> = <span class="mxinfo " id="T4:U52">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="203,28" id="srcline28">28</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
