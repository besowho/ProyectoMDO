<pre class="code">
<span class="srcline"><span class="lineno"><a href="86,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,35" id="srcline35">35</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S15T5U123">mixture</span> = opt_param_space_to_mixture_prior( <span class="var type1" id="S16T39U126">params</span>, <span class="var type1" id="S17T8U127">im_size</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="86,36" id="srcline36">36</a></span><span class="line"> <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="86,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T4:U4"><span class="var type1" id="S18T4U130">W</span> = <span class="mxinfo " id="T4:U6"><span class="var type1" id="S17T8U132">im_size</span>(<span class="mxinfo " id="T4:U8">2</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T4:U9"><span class="var type1" id="S19T4U136">H</span> = <span class="mxinfo " id="T4:U11"><span class="var type1" id="S17T8U138">im_size</span>(<span class="mxinfo " id="T4:U13">1</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,41" id="srcline41">41</a></span><span class="line"><span class="comment">% project to pixels</span></span></span>
<span class="srcline"><span class="lineno"><a href="86,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T4:U14"><span class="var type1" id="S20T4U142">n_mu_batch</span> = <span class="mxinfo " id="T4:U16">4</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo " id="T4:U17"><span class="var type1" id="S21T4U146">n_s_batch</span> = <span class="mxinfo " id="T4:U19">5</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo " id="T5:U20"><span class="var type1" id="S15T5U150">mixture</span> = <span class="mxinfo " id="T5:U22"><span class="fcn" id="F50N2:B152">MixtureComponent</span>(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="86,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T40:U23"><span class="var type1" id="S23T40U156">Mu_params</span> = <span class="mxinfo " id="T40:U25"><span class="var type1" id="S16T39U158">params</span>(<span class="mxinfo " id="T396:U27"><span class="mxinfo " id="T4:U28">1</span>:<span class="mxinfo " id="T4:U29">end-3*<span class="var type1" id="S21T4U166">n_s_batch</span></span></span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T43:U31"><span class="var type1" id="S25T43U169">S_params</span> = <span class="mxinfo " id="T43:U33"><span class="var type1" id="S16T39U171">params</span>(<span class="mxinfo " id="T397:U35"><span class="mxinfo " id="T4:U36">end-3*<span class="var type1" id="S21T4U179">n_s_batch</span>+1</span>:<span class="mxinfo " id="T4:U38">end</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,49" id="srcline49">49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,50" id="srcline50">50</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S26T4U185">i</span> = <span class="mxinfo " id="T4:U40">1</span> : 3</span></span>
<span class="srcline"><span class="lineno"><a href="86,51" id="srcline51">51</a></span><span class="line">     <span class="mxinfo " id="T6:U41"><span class="var type1" id="S27T6U191">mu</span> = <span class="mxinfo " id="T6:U43">reshape(<span class="mxinfo " id="T398:U44">[<span class="mxinfo " id="T4:U45"><span class="var type1" id="S18T4U197">W</span>/<span class="mxinfo " id="T4:U47">2</span></span>; <span class="mxinfo " id="T399:U48"><span class="var type1" id="S23T40U201">Mu_params</span>( <span class="mxinfo " id="T4:U50"><span class="mxinfo " id="T4:U51"><span class="mxinfo " id="T4:U52"><span class="var type1" id="S20T4U205">n_mu_batch</span></span>*(<span class="mxinfo " id="T4:U54"><span class="var type1" id="S26T4U208">i</span>-<span class="mxinfo " id="T4:U56">1</span></span>)</span> + <span class="mxinfo " id="T4:U57">1</span></span> : <span class="mxinfo " id="T4:U58"><span class="mxinfo " id="T4:U59"><span class="var type1" id="S20T4U212">n_mu_batch</span></span>*<span class="var type1" id="S26T4U213">i</span></span> )</span>]</span>, 5, 1)</span></span> ; <span class="comment">%disp('Size of mu :'); disp(size(mu)); </span></span></span>
<span class="srcline"><span class="lineno"><a href="86,52" id="srcline52">52</a></span><span class="line">     <span class="mxinfo " id="T4:U62"><span class="mxinfo " id="T4:U63"><span class="var type1" id="S27T6U219">mu</span>(<span class="mxinfo " id="T4:U65">2</span>)</span> = <span class="mxinfo " id="T4:U66"><span class="mxinfo " id="T4:U67"><span class="var type1" id="S27T6U223">mu</span>(<span class="mxinfo " id="T4:U69">2</span>)</span>*<span class="mxinfo " id="T4:U70"><span class="var type1" id="S19T4U225">H</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,53" id="srcline53">53</a></span><span class="line">     <span class="mxinfo " id="T6:U72"><span class="mxinfo " id="T6:U73"><span class="mxinfo " id="T15:U74"><span class="var type1" id="S15T5U230">mixture</span>(<span class="var type1" id="S26T4U231">i</span>)</span>.Mu</span> =<span class="var type1" id="S27T6U233">mu</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,54" id="srcline54">54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="86,55" id="srcline55">55</a></span><span class="line">     <span class="mxinfo " id="T6:U78"><span class="var type1" id="S29T6U236">S</span> = <span class="mxinfo " id="T6:U80">reshape(<span class="mxinfo " id="T358:U81"><span class="var type1" id="S25T43U240">S_params</span>( <span class="mxinfo " id="T4:U83"><span class="mxinfo " id="T4:U84"><span class="mxinfo " id="T4:U85"><span class="var type1" id="S21T4U244">n_s_batch</span></span>*(<span class="mxinfo " id="T4:U87"><span class="var type1" id="S26T4U247">i</span>-<span class="mxinfo " id="T4:U89">1</span></span>)</span> + <span class="mxinfo " id="T4:U90">1</span></span> : <span class="mxinfo " id="T4:U91"><span class="mxinfo " id="T4:U92"><span class="var type1" id="S21T4U251">n_s_batch</span></span>*<span class="var type1" id="S26T4U252">i</span></span> )</span>, 5, 1)</span></span>; <span class="comment">%disp('Size of S: '); disp(size(S));</span></span></span>
<span class="srcline"><span class="lineno"><a href="86,56" id="srcline56">56</a></span><span class="line">     <span class="mxinfo " id="T8:U95"><span class="mxinfo " id="T8:U96"><span class="var type1" id="S29T6U258">S</span>(<span class="mxinfo " id="T8:U98"><span class="mxinfo " id="T4:U99">1</span>:<span class="mxinfo " id="T4:U100">2</span></span>)</span> = <span class="mxinfo " id="T329:U101"><span class="mxinfo " id="T329:U102"><span class="var type1" id="S29T6U264">S</span>(<span class="mxinfo " id="T8:U104"><span class="mxinfo " id="T4:U105">1</span>:<span class="mxinfo " id="T4:U106">2</span></span>)</span>.*<span class="mxinfo " id="T329:U107">[<span class="mxinfo " id="T4:U108"><span class="var type1" id="S19T4U270">H</span></span>;<span class="mxinfo " id="T4:U110"><span class="var type1" id="S18T4U272">W</span></span>]</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,57" id="srcline57">57</a></span><span class="line">     <span class="mxinfo " id="T7:U112"><span class="mxinfo " id="T7:U113"><span class="mxinfo " id="T15:U114"><span class="var type1" id="S15T5U277">mixture</span>(<span class="var type1" id="S26T4U278">i</span>)</span>.Cov</span> = <span class="mxinfo " id="T7:U117">diag(<span class="mxinfo " id="T6:U118"><span class="var type1" id="S29T6U283">S</span>.^2</span>)</span></span> ;     </span></span>
<span class="srcline"><span class="lineno"><a href="86,58" id="srcline58">58</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="86,59" id="srcline59">59</a></span><span class="line">     <span class="mxinfo " id="T7:U120"><span class="mxinfo " id="T7:U121"><span class="mxinfo " id="T15:U122"><span class="var type1" id="S15T5U289">mixture</span>(<span class="var type1" id="S26T4U290">i</span>)</span>.Prec</span> =  <span class="mxinfo " id="T7:U125">inv(<span class="mxinfo " id="T7:U126"><span class="mxinfo " id="T15:U127"><span class="var type1" id="S15T5U296">mixture</span>(<span class="var type1" id="S26T4U297">i</span>)</span>.Cov</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="86,60" id="srcline60">60</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="86,61" id="srcline61">61</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
